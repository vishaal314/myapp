./robust_service_fix.sh
ğŸ”§ ROBUST SERVICE FIX - Advanced Diagnostics & Restart
=====================================================
Targeting: Health check failures, false negative process detection

ğŸ” PART 1: Advanced service diagnostics
=======================================
ğŸ“Š Process Detection (Multiple Methods):
   Method 1 (ps aux): Streamlit=0, Redis=0
   Method 2 (pgrep): Streamlit=0, Redis=0
   Method 3 (pidof): Python=0, Redis=0
   Method 4 (ss): Port 5000=0, Port 6379=0
âœ… Diagnostic data collected

ğŸ§  PART 2: Intelligent service restart logic
===========================================
ğŸ”´ Streamlit: No processes detected - needs restart
ğŸ”´ Redis: No processes detected - needs restart

ğŸ›‘ PART 3: Aggressive service cleanup & restart
==============================================
ğŸ§¹ Cleaning up any stale processes...
No streamlit processes to kill
No redis processes to kill
No app.py processes to kill
âœ… Cleanup completed

ğŸ”´ PART 4: Redis restart with fallbacks
======================================
ğŸ”§ Starting Redis server...
   Trying method 1: redis-server daemon...
âš ï¸  Redis: Started but connection test failed

ğŸ–¥ï¸  PART 5: Streamlit restart with fallbacks
===========================================
ğŸ”§ Starting Streamlit server...
   Trying method 1: nohup background...
   Trying method 2: direct background...
./robust_service_fix.sh: line 213: streamlit: command not found
   Trying method 3: python direct...
./robust_service_fix.sh: line 227: python: command not found
âœ… Streamlit startup attempts completed

ğŸ©º PART 6: Comprehensive health verification
===========================================
â³ Waiting for services to fully initialize...
ğŸ” Running comprehensive health checks...
ğŸ“Š Final Process Count:
   Streamlit processes: 0
   Redis processes: 0

ğŸŒ HTTP Connectivity Tests:
   Attempt 1: HTTP 000000
   Waiting 10 seconds before retry...
   Attempt 2: HTTP 000000
   Waiting 10 seconds before retry...
   Attempt 3: HTTP 000000
   Waiting 10 seconds before retry...
   Attempt 4: HTTP 000000
   Waiting 10 seconds before retry...
   Attempt 5: HTTP 000000

ğŸ”´ Redis Connectivity Tests:
âŒ Redis method 1: FAIL
âŒ Redis method 2: FAIL

ğŸ“Š FINAL ROBUST SERVICE STATUS
==============================

âš ï¸  ADVANCED TROUBLESHOOTING NEEDED
=================================

âŒ No processes detected after restart attempts
âŒ HTTP Status: 000000

ğŸ” Advanced Diagnostics:
   ğŸ“‹ Check logs: tail -f streamlit_robust.log
   ğŸ” Memory usage: free -h
   ğŸ’¾ Disk space: df -h
   ğŸ”§ Python path: which python
   ğŸ“¦ Streamlit install: pip show streamlit

ğŸ“‹ LOG FILES CREATED:
====================
ğŸ“„ Streamlit: streamlit_robust.log
ğŸ“„ Process ID: streamlit.pid

ğŸ“„ Recent Streamlit Log (last 10 lines):
nohup: failed to run command 'streamlit': No such file or directory

âœ… ROBUST SERVICE FIX COMPLETE!
Multiple restart methods attempted with comprehensive diagnostics
root@vishaalnoord7:/opt/dataguardian#