================================================================================
OCTROOICONCLUSIES (CLAIMS)
Patent #2: Intelligente Database Scanner met Adaptieve Sampling
================================================================================

CONCLUSIE 1 (HOOFDCONCLUSIE - ONAFHANKELIJK):

Een intelligente databasescanner voor het detecteren van Persoonlijk 
Identificeerbare Informatie (PII) in relationele databases, omvattende:

a) Een database connector module die verbindingen maakt met meerdere 
   database-engines, namelijk:
   - PostgreSQL databases via psycopg2 connector library
   - MySQL databases via mysql.connector library  
   - Microsoft SQL Server databases via pyodbc connector library
   waarbij de connector module automatisch het juiste driver-protocol 
   selecteert op basis van het database-type parameter;

b) Een schema analyser die automatisch database-structuren analyseert door:
   - Het ophalen van tabel-metadata via information_schema queries
   - Het berekenen van row counts per tabel via COUNT(*) queries
   - Het identificeren van kolom-datatypes en kolomnamen
   - Het genereren van een complete schema-inventaris met tabel-hiërarchie;

c) Een prioriteits-calculator die risico-scores berekent voor iedere tabel 
   volgens het volgende algoritme:
   - Score 3.0 voor tabellen met namen bevattende: 'user', 'customer', 
     'employee', 'person', 'medical', 'health', 'patient'
   - Score 2.8 voor tabellen met namen bevattende: 'payment', 'transaction', 
     'invoice', 'billing'
   - Score 2.5 voor tabellen met namen bevattende: 'communication', 'message', 
     'email', 'notification'
   - Score 2.0 voor tabellen met namen bevattende: 'address', 'location', 
     'contact'
   - Score 1.5 voor alle overige tabellen
   - Extra score-bonus (+0.5 tot +0.8) voor kolommen met PII-indicatoren 
     zoals 'email', 'phone', 'ssn', 'bsn';

d) Een adaptieve sampling engine die drie configureerbare scan-modi 
   implementeert:
   - FAST mode: 100 rijen sample per tabel met 2 parallelle workers
   - SMART mode: 300 rijen sample per tabel met 3 parallelle workers
   - DEEP mode: 500 rijen sample per tabel met 3 parallelle workers
   waarbij de sample size en worker count statisch zijn gedefinieerd per 
   mode en niet dynamisch worden aangepast;

e) Een PII-detectie engine die Nederlands-specifieke persoonsgegevens 
   identificeert, inclusief:
   - BSN-nummers (Burgerservicenummer) bestaande uit 9 cijfers, gevalideerd 
     volgens het officiële 11-proef algoritme waarbij de checksum wordt 
     berekend als: (9×d₁ + 8×d₂ + 7×d₃ + 6×d₄ + 5×d₅ + 4×d₆ + 3×d₇ + 2×d₈ - 1×d₉) 
     mod 11 = 0
   - Nederlandse e-mailadressen met .nl top-level domain
   - Nederlandse telefoonnummers in formaten +31 6 of 06
   - Nederlandse postcodes in formaat nnnn XX (4 cijfers + 2 letters)
   waarbij ongeldige BSN-nummers met incorrecte checksums worden afgewezen;

f) Een parallel processing manager die gebruik maakt van Python's 
   concurrent.futures.ThreadPoolExecutor met configureerbare worker-pools 
   waarbij:
   - Het aantal workers exact 2 is voor FAST mode scans
   - Het aantal workers exact 3 is voor SMART en DEEP mode scans
   - Elke worker een afzonderlijke tabel scant zonder data-overlapping
   - Results van alle workers worden geaggregeerd in een centrale collector.

================================================================================

CONCLUSIE 2 (AFHANKELIJK VAN CONCLUSIE 1):

Een databasescanner volgens conclusie 1, waarbij de database connector module 
verder omvat:

a) Een connectie-parameter validatie systeem dat verifieert:
   - Host parameter is een geldige hostname of IP-adres
   - Port parameter is een integer tussen 1 en 65535
   - Database naam parameter is een niet-lege string
   - User credentials zijn aanwezig en niet-leeg;

b) Een connection pooling mechanisme dat:
   - Maximaal 10 gelijktijdige database connecties onderhoudt
   - Connecties hergebruikt voor opeenvolgende queries
   - Automatisch time-outs afhandelt na 30 seconden inactiviteit
   - Failed connections opnieuw probeert met exponential backoff;

c) Een error handling laag die database-specifieke excepties omzet naar 
   gestandaardiseerde error codes, inclusief:
   - CONNECTION_FAILED (code: 1001) voor authenticatie fouten
   - QUERY_TIMEOUT (code: 1002) voor queries die >60 seconden duren
   - PERMISSION_DENIED (code: 1003) voor ontbrekende SELECT privileges
   - INVALID_SYNTAX (code: 1004) voor SQL syntax errors.

================================================================================

CONCLUSIE 3 (AFHANKELIJK VAN CONCLUSIE 1):

Een databasescanner volgens conclusie 1, waarbij de prioriteits-calculator 
verder omvat:

a) Een naam-matching algoritme dat case-insensitive substring matching 
   toepast op tabelnamen, waarbij:
   - Tabelnaam wordt geconverteerd naar lowercase voor vergelijking
   - Partial matches worden geaccepteerd (bijv. 'customers' matcht 'customer')
   - Meerdere keywords in één tabelnaam resulteren in de hoogste score
   - Speciale karakters (_, -, .) worden genegeerd in matching;

b) Een kolom-analyse module die prioriteit verhoogt op basis van:
   - Kolommen met naam 'email' of 'e_mail': +0.5 punten
   - Kolommen met naam 'phone' of 'telephone': +0.3 punten
   - Kolommen met naam 'ssn', 'bsn' of 'social_security': +0.8 punten
   - Kolommen met datatype 'VARCHAR' of 'TEXT' krijgen extra analyse
   - Maximale totale score wordt gecapped op 5.0 ongeacht aantal matches;

c) Een risico-classificatie systeem dat tabellen categoriseert in:
   - HIGH risk (score ≥ 2.5): Verplichte scanning in alle modes
   - MEDIUM risk (score 1.5 - 2.4): Scanning in SMART en DEEP modes
   - LOW risk (score < 1.5): Alleen scanning in DEEP mode
   waarbij de classificatie wordt opgeslagen in de schema-metadata.

================================================================================

CONCLUSIE 4 (AFHANKELIJK VAN CONCLUSIE 1):

Een databasescanner volgens conclusie 1, waarbij de adaptieve sampling engine 
verder omvat:

a) Een strategische tabel-selectie algoritme dat:
   - In FAST mode: maximum 15 tabellen scant, gesorteerd op hoogste prioriteit
   - In SMART mode: alle tabellen scant zonder limitatie
   - In DEEP mode: maximum 75 tabellen scant, gesorteerd op hoogste prioriteit
   waarbij tabellen altijd worden gesorteerd op descending priority score 
   voordat de limiet wordt toegepast;

b) Een sample query generator die SQL LIMIT clauses construeert als:
   - "SELECT * FROM {table_name} LIMIT {sample_size}" voor PostgreSQL en MySQL
   - "SELECT TOP {sample_size} * FROM {table_name}" voor SQL Server
   waarbij {sample_size} exact 100, 300 of 500 is afhankelijk van scan mode;

c) Een row sampling verificatie mechanisme dat:
   - Controleert of het werkelijke aantal gescande rijen ≤ sample_size is
   - Een waarschuwing logt als een tabel minder rijen heeft dan sample_size
   - Het percentage database-coverage berekent als (gescande_rijen / totale_rijen) × 100%
   - Statistieken bijhoudt over minimum, maximum en gemiddelde sample sizes.

================================================================================

CONCLUSIE 5 (AFHANKELIJK VAN CONCLUSIE 1):

Een databasescanner volgens conclusie 1, waarbij de PII-detectie engine verder 
omvat:

a) Een BSN-validatie module die het 11-proef algoritme implementeert volgens:
   
   STAP 1: Input validatie
   - Controleer dat BSN exact 9 cijfers bevat
   - Reject BSN met letters of speciale karakters
   - Accept BSN met leading zeros (bijv. 012345678)
   
   STAP 2: Checksum berekening
   - Voor positie i=0 tot i=7: vermenigvuldig digit met (9-i)
   - Voor positie i=8: vermenigvuldig digit met -1
   - Som alle producten: checksum = Σ(digit[i] × multiplier[i])
   
   STAP 3: Modulo validatie
   - Bereken: checksum mod 11
   - BSN is GELDIG als resultaat = 0
   - BSN is ONGELDIG als resultaat ≠ 0
   
   VOORBEELD BEREKENING voor BSN 111222333:
   (1×9) + (1×8) + (1×7) + (2×6) + (2×5) + (2×4) + (3×3) + (3×2) - (3×1)
   = 9 + 8 + 7 + 12 + 10 + 8 + 9 + 6 - 3 = 66
   66 mod 11 = 0 → GELDIG BSN;

b) Een regex-gebaseerde extractie systeem voor Nederlandse PII-patterns:
   - Email: r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.nl\b'
   - Telefoon: r'\b(06|(\+31\s?6))[\s-]?\d{8}\b'
   - Postcode: r'\b\d{4}\s?[A-Z]{2}\b'
   - IBAN: r'\bNL\d{2}[A-Z]{4}\d{10}\b'
   waarbij matches worden geëxtraheerd uit VARCHAR, TEXT en CHAR kolommen;

c) Een GDPR artikel-mapping systeem dat detecteerde PII koppelt aan:
   - BSN → Artikel 9 (Bijzondere categorieën persoonsgegevens)
   - Email/Phone → Artikel 6 (Rechtmatigheid verwerking)
   - Medical data → Artikel 9 (Bijzondere categorieën)
   - Financial data → Artikel 6 + Artikel 32 (Beveiliging)
   waarbij elk gevonden PII-item wordt gelabeld met het relevante artikel.

================================================================================

CONCLUSIE 6 (AFHANKELIJK VAN CONCLUSIE 1):

Een databasescanner volgens conclusie 1, waarbij de parallel processing manager 
verder omvat:

a) Een ThreadPoolExecutor configuratie systeem dat:
   - Voor FAST mode: ThreadPoolExecutor(max_workers=2) initialiseert
   - Voor SMART mode: ThreadPoolExecutor(max_workers=3) initialiseert  
   - Voor DEEP mode: ThreadPoolExecutor(max_workers=3) initialiseert
   waarbij max_workers een statische waarde is per mode en niet dynamisch 
   wordt aangepast op basis van CPU cores of database-belasting;

b) Een work distribution algoritme dat:
   - Tabellen verdeelt over workers op basis van priority score
   - Zorgt voor load balancing door tabellen te sorteren op geschat row count
   - Elke worker een gelijk aantal tabellen toewijst (± 1 tabel verschil)
   - High-priority tabellen als eerste toewijst aan beschikbare workers;

c) Een result aggregation mechanisme dat:
   - Futures van alle workers verzamelt via executor.submit() calls
   - Wacht tot alle futures compleet zijn via concurrent.futures.wait()
   - Exceptions van gefaalde workers caught en logt zonder scan te stoppen
   - Succesvolle resultaten merged in een master result dictionary met keys:
     * 'total_findings': som van alle PII findings
     * 'total_rows_scanned': som van alle gescande rijen
     * 'tables_scanned': aantal succesvol gescande tabellen
     * 'scan_duration': totale tijd in seconden
     * 'findings_by_type': dictionary met PII-type als key en count als value.

================================================================================
TOTAAL AANTAL CONCLUSIES: 6
================================================================================

HOOFDCONCLUSIE: Conclusie 1 (onafhankelijk)
AFHANKELIJKE CONCLUSIES: Conclusies 2, 3, 4, 5, 6 (elk afhankelijk van conclusie 1)

BESCHERMINGSOMVANG:
De beschermingsomvang van dit octrooi wordt bepaald door de conclusies, 
waarbij de beschrijving en tekeningen dienen ter toelichting maar niet ter 
beperking van de claims.

INVENTIEVE STAP RECHTVAARDIGING:
Deze conclusies bevatten meerdere inventieve stappen die NIET voor de hand 
liggend zijn voor een vakman:

1. De specifieke combinatie van sample sizes (100/300/500) met worker counts 
   (2/3/3) is NIET standaard in de industrie en vereist empirische optimalisatie

2. De BSN 11-proef validatie is NIET geïmplementeerd in bestaande database 
   scanners (OneTrust, BigID, Varonis)

3. Het prioriteits-scoring systeem met Nederlandse risico-factoren is een 
   NIEUWE benadering specifiek voor UAVG compliance

4. De combinatie van adaptieve sampling + parallel processing + BSN validatie 
   in één geïntegreerd systeem is NIEUW en NIET-VOOR-DE-HAND-LIGGEND

NIEUWHEID RECHTVAARDIGING:
Geen enkele bestaande database scanner combineert:
- Adaptieve sampling met 3 exacte modi (100/300/500 rijen)
- BSN-validatie met 11-proef algoritme
- Nederlandse PII-detectie (.nl emails, NL postcodes, +31 telefoons)
- Multi-database support (PostgreSQL, MySQL, SQL Server)
- Prioriteits-based scanning met 6 risico-categorieën

INDUSTRIËLE TOEPASBAARHEID:
Deze uitvinding is direct toepasbaar voor:
- GDPR/AVG compliance audits in Nederlandse organisaties
- UAVG-specifieke PII-inventarisatie
- Database security assessments
- Data protection impact assessments (DPIA)
- Automated privacy compliance monitoring

================================================================================
END OF CLAIMS
================================================================================
