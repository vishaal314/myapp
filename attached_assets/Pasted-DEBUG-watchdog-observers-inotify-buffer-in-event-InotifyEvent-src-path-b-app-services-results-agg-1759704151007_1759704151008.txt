DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/results_aggregator.py', wd=7, mask=IN_CLOSE_NOWRITE, cookie=0, name='results_aggregator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/results_aggregator.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='results_aggregator.py'>
INFO:services.encryption_service:Local KMS provider initialized
WARNING:services.encryption_service:boto3 not available for AWS KMS integration
INFO:services.encryption_service:Key management initialized
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/utils/secure_auth_enhanced.py', wd=1, mask=IN_OPEN, cookie=0, name='secure_auth_enhanced.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/utils/secure_auth_enhanced.py', wd=8, mask=IN_OPEN, cookie=0, name='secure_auth_enhanced.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/utils/secure_auth_enhanced.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='secure_auth_enhanced.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/utils/secure_auth_enhanced.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='secure_auth_enhanced.py'>
INFO:services.multi_tenant_service:Tenant isolation columns may already exist: relation "scans" does not exist

INFO:services.multi_tenant_service:Initializing Row Level Security for tenant isolation
ERROR:services.multi_tenant_service:Failed to initialize Row Level Security: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.multi_tenant_service:Continuing without RLS - manual configuration may be required
INFO:services.multi_tenant_service:Multi-tenant database schema initialized successfully with RLS
ERROR:services.multi_tenant_service:Failed to load tenant configs: relation "tenants" does not exist
LINE 4:             FROM tenants WHERE status = 'active'
                         ^

ERROR:services.multi_tenant_service:Failed to create tenant default_org: relation "tenants" does not exist
LINE 2:             INSERT INTO tenants
                                ^

ERROR:services.multi_tenant_service:Failed to create default tenant: Tenant creation failed: relation "tenants" does not exist
LINE 2:             INSERT INTO tenants
                                ^

INFO:services.multi_tenant_service:Multi-tenant service initialized with organization isolation
INFO:services.results_aggregator:Multi-tenant service initialized for secure tenant isolation
DEBUG:services.multi_tenant_service:Secure connection established for organization system_admin
DEBUG:services.results_aggregator:Created performance index: idx_scans_username_timestamp
DEBUG:services.results_aggregator:Created performance index: idx_scans_organization_timestamp
DEBUG:services.results_aggregator:Created performance index: idx_scans_scan_type
DEBUG:services.results_aggregator:Created performance index: idx_scans_timestamp
DEBUG:services.results_aggregator:Created performance index: idx_scans_composite
DEBUG:services.results_aggregator:Migration note: column "organization_id" of relation "scans" already exists

ERROR:services.results_aggregator:Error creating database tables: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error initializing database: Database initialization required for enterprise security compliance: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.results_aggregator:Non-strict mode: falling back to file-based storage
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, m