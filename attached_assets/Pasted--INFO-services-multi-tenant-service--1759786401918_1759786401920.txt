                                                            ^

INFO:services.multi_tenant_service:Multi-tenant service initialized with organization isolation
INFO:services.results_aggregator:Multi-tenant service initialized for secure tenant isolation
DEBUG:services.multi_tenant_service:Secure connection established for organization system_admin
DEBUG:services.results_aggregator:Index creation note: column "timestamp" does not exist

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Migration note: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error creating database tables: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error initializing database: Database initialization required for enterprise security compliance: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.results_aggregator:Non-strict mode: falling back to file-based storage
INFO:services.results_aggregator:File-based storage initialized for non-strict mode
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: Retrieved 0 total scans for user vishaal314
INFO:__main__:Dashboard: No scans found for user vishaal314, getting all recent scans
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: Raw aggregator returned 0 scans for user vishaal314
INFO:__main__:Dashboard: Processing 0 completed scans from aggregator
Error retrieving recent scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
Error retrieving recent scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
INFO:services.multi_tenant_service:Tenant isolation columns may already exist: relation "audit_log" does not exist

INFO:services.multi_tenant_service:Initializing Row Level Security for tenant isolation
ERROR:services.multi_tenant_service:Failed to initialize Row Level Security: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.multi_tenant_service:Continuing without RLS - manual configuration may be required
INFO:services.multi_tenant_service:Multi-tenant database schema initialized successfully with RLS
ERROR:services.multi_tenant_service:Failed to load tenant configs: column "max_users" does not exist
LINE 2: ... SELECT organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create tenant default_org: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create default tenant: Tenant creation failed: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

INFO:services.multi_tenant_service:Multi-tenant service initialized with organization isolation
INFO:services.results_aggregator:Multi-tenant service initialized for secure tenant isolation
DEBUG:services.multi_tenant_service:Secure connection established for organization system_admin
DEBUG:services.results_aggregator:Index creation note: column "timestamp" does not exist

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Migration note: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error creating database tables: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error initializing database: Database initialization required for enterprise security compliance: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.results_aggregator:Non-strict mode: falling back to file-based storage
Error retrieving user scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
Error retrieving user scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
INFO:services.results_aggregator:File-based storage initialized for non-strict mode
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: Direct database query found 0 total scans for user vishaal314
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: No user-specific scans, using 0 total scans from database
INFO:__main__:Dashboard: Manual date filtering found 0 scans within 30 days
INFO:__main__:Dashboard: Activity tracker found 0 total activities, 0 completed scans
INFO:__main__:Dashboard: Found 0 total activities, 0 today in activity tracker
INFO:__main__:Dashboard: Combining 0 aggregator scans + 0 today's activities
INFO:__main__:Dashboard DISPLAY: Showing metrics - Scans: 0, PII: 0, Compliance: 94.5%, Issues: 0
INFO:services.multi_tenant_service:Tenant isolation columns may already exist: relation "audit_log" does not exist

INFO:services.multi_tenant_service:Initializing Row Level Security for tenant isolation
ERROR:services.multi_tenant_service:Failed to initialize Row Level Security: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.multi_tenant_service:Continuing without RLS - manual configuration may be required
INFO:services.multi_tenant_service:Multi-tenant database schema initialized successfully with RLS
ERROR:services.multi_tenant_service:Failed to load tenant configs: column "max_users" does not exist
LINE 2: ... SELECT organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create tenant default_org: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create default tenant: Tenant creation failed: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

INFO:services.multi_tenant_service:Multi-tenant service initialized with organization isolation
INFO:services.results_aggregator:Multi-tenant service initialized for secure tenant isolation
DEBUG:services.multi_tenant_service:Secure connection established for organization system_admin
DEBUG:services.results_aggregator:Index creation note: column "timestamp" does not exist

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Migration note: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error creating database tables: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error initializing database: Database initialization required for enterprise security compliance: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.results_aggregator:Non-strict mode: falling back to file-based storage
INFO:services.results_aggregator:File-based storage initialized for non-strict mode
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
INFO:__main__:Dashboard: Fresh aggregator returned 0 scans for recent activity display
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
INFO:__main__:Dashboard: No user-specific scans, using 0 total recent scans from all users
INFO:__main__:Dashboard: Ensuring all scanner types update dashboard data properly
Error retrieving recent scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
Error retrieving recent scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
2025-10-06 21:19:10,605 - scanner.code_profiler - INFO - Performance Monitor [main_app_initialization]: 0.714s, Memory: 0.0MB
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/logs/dataguardian_scanner.log', wd=4, mask=IN_MODIFY, cookie=0, name='dataguardian_scanner.log'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=1, mask=IN_OPEN, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=8, mask=IN_OPEN, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='license_integration.py'>
WARNING:root:License imports failed: cannot import name 'PricingTier' from 'config.pricing_config' (/app/config/pricing_config.py)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=1, mask=IN_OPEN, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=3, mask=IN_OPEN, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=3, mask=IN_CLOSE_NOWRITE, cookie=0, name='pricing_display.py'>
WARNING:root:Pricing imports failed: cannot import name 'PricingTier' from 'config.pricing_config' (/app/config/pricing_config.py)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=8, mask=IN_OPEN, cookie=0, name='download_reports.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='download_reports.py'>
INFO:__main__:Performance optimizations initialized successfully
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_OPEN, cookie=0, name='en.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_CLOSE_NOWRITE, cookie=0, name='en.json'>
INIT - Successfully initialized translations for: en
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=8, mask=IN_OPEN, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=1, mask=IN_OPEN, cookie=0, name='download_reports.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='download_reports.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=1, mask=IN_OPEN, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:__main__:Enterprise integration not available (development mode)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/secure_users.json', wd=1, mask=IN_OPEN, cookie=0, name='secure_users.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/secure_users.json', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='secure_users.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_OPEN, cookie=0, name='en.json'>
2025-10-06 21:19:12,670 - scanner.code_profiler - INFO - Performance Monitor [main_app_initialization]: 0.040s, Memory: 0.0MB
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_CLOSE_NOWRITE, cookie=0, name='en.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/logs/dataguardian_scanner.log', wd=4, mask=IN_MODIFY, cookie=0, name='dataguardian_scanner.log'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=1, mask=IN_OPEN, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=8, mask=IN_OPEN, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='license_integration.py'>
WARNING:root:License imports failed: cannot import name 'PricingTier' from 'config.pricing_config' (/app/config/pricing_config.py)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=1, mask=IN_OPEN, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=3, mask=IN_OPEN, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=3, mask=IN_CLOSE_NOWRITE, cookie=0, name='pricing_display.py'>
WARNING:root:Pricing imports failed: cannot import name 'PricingTier' from 'config.pricing_config' (/app/config/pricing_config.py)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=1, mask=IN_OPEN, cookie=0, name='download_reports.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='download_reports.py'>
INFO:__main__:Performance optimizations initialized successfully
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=8, mask=IN_OPEN, cookie=0, name='download_reports.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='download_reports.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_OPEN, cookie=0, name='en.json'>
INIT - Successfully initialized translations for: en
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=1, mask=IN_OPEN, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_CLOSE_NOWRITE, cookie=0, name='en.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=8, mask=IN_OPEN, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:__main__:Enterprise integration not available (development mode)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/secure_users.json', wd=1, mask=IN_OPEN, cookie=0, name='secure_users.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/secure_users.json', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='secure_users.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_OPEN, cookie=0, name='en.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_CLOSE_NOWRITE, cookie=0, name='en.json'>
INFO:services.multi_tenant_service:Tenant isolation columns may already exist: relation "audit_log" does not exist

INFO:services.multi_tenant_service:Initializing Row Level Security for tenant isolation
ERROR:services.multi_tenant_service:Failed to initialize Row Level Security: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.multi_tenant_service:Continuing without RLS - manual configuration may be required
INFO:services.multi_tenant_service:Multi-tenant database schema initialized successfully with RLS
ERROR:services.multi_tenant_service:Failed to load tenant configs: column "max_users" does not exist
LINE 2: ... SELECT organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create tenant default_org: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create default tenant: Tenant creation failed: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

INFO:services.multi_tenant_service:Multi-tenant service initialized with organization isolation
INFO:services.results_aggregator:Multi-tenant service initialized for secure tenant isolation
DEBUG:services.multi_tenant_service:Secure connection established for organization system_admin
DEBUG:services.results_aggregator:Index creation note: column "timestamp" does not exist

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Migration note: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error creating database tables: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error initializing database: Database initialization required for enterprise security compliance: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.results_aggregator:Non-strict mode: falling back to file-based storage
INFO:services.results_aggregator:File-based storage initialized for non-strict mode
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
Error retrieving recent scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: Retrieved 0 total scans for user vishaal314
INFO:__main__:Dashboard: No scans found for user vishaal314, getting all recent scans
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
Error retrieving recent scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: Raw aggregator returned 0 scans for user vishaal314
INFO:__main__:Dashboard: Processing 0 completed scans from aggregator
INFO:services.multi_tenant_service:Tenant isolation columns may already exist: relation "audit_log" does not exist

INFO:services.multi_tenant_service:Initializing Row Level Security for tenant isolation
ERROR:services.multi_tenant_service:Failed to initialize Row Level Security: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.multi_tenant_service:Continuing without RLS - manual configuration may be required
INFO:services.multi_tenant_service:Multi-tenant database schema initialized successfully with RLS
ERROR:services.multi_tenant_service:Failed to load tenant configs: column "max_users" does not exist
LINE 2: ... SELECT organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create tenant default_org: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create default tenant: Tenant creation failed: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

INFO:services.multi_tenant_service:Multi-tenant service initialized with organization isolation
INFO:services.results_aggregator:Multi-tenant service initialized for secure tenant isolation
DEBUG:services.multi_tenant_service:Secure connection established for organization system_admin
DEBUG:services.results_aggregator:Index creation note: column "timestamp" does not exist

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Migration note: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error creating database tables: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error initializing database: Database initialization required for enterprise security compliance: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.results_aggregator:Non-strict mode: falling back to file-based storage
INFO:services.results_aggregator:File-based storage initialized for non-strict mode
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
Error retrieving user scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: Direct database query found 0 total scans for user vishaal314
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
Error retrieving user scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: No user-specific scans, using 0 total scans from database
INFO:__main__:Dashboard: Manual date filtering found 0 scans within 30 days
INFO:__main__:Dashboard: Activity tracker found 0 total activities, 0 completed scans
INFO:__main__:Dashboard: Found 0 total activities, 0 today in activity tracker
INFO:__main__:Dashboard: Combining 0 aggregator scans + 0 today's activities
INFO:__main__:Dashboard DISPLAY: Showing metrics - Scans: 0, PII: 0, Compliance: 94.5%, Issues: 0
INFO:services.multi_tenant_service:Tenant isolation columns may already exist: relation "audit_log" does not exist

INFO:services.multi_tenant_service:Initializing Row Level Security for tenant isolation
ERROR:services.multi_tenant_service:Failed to initialize Row Level Security: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.multi_tenant_service:Continuing without RLS - manual configuration may be required
INFO:services.multi_tenant_service:Multi-tenant database schema initialized successfully with RLS
ERROR:services.multi_tenant_service:Failed to load tenant configs: column "max_users" does not exist
LINE 2: ... SELECT organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create tenant default_org: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

ERROR:services.multi_tenant_service:Failed to create default tenant: Tenant creation failed: column "max_users" of relation "tenants" does not exist
LINE 3: ...       (organization_id, organization_name, tier, max_users,...
                                                             ^

INFO:services.multi_tenant_service:Multi-tenant service initialized with organization isolation
INFO:services.results_aggregator:Multi-tenant service initialized for secure tenant isolation
DEBUG:services.multi_tenant_service:Secure connection established for organization system_admin
DEBUG:services.results_aggregator:Index creation note: column "timestamp" does not exist

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Index creation note: current transaction is aborted, commands ignored until end of transaction block

DEBUG:services.results_aggregator:Migration note: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error creating database tables: current transaction is aborted, commands ignored until end of transaction block

ERROR:services.results_aggregator:Error initializing database: Database initialization required for enterprise security compliance: current transaction is aborted, commands ignored until end of transaction block

WARNING:services.results_aggregator:Non-strict mode: falling back to file-based storage
INFO:services.results_aggregator:File-based storage initialized for non-strict mode
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
Error retrieving recent scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: Fresh aggregator returned 0 scans for recent activity display
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
WARNING:services.multi_tenant_service:Access denied: Unknown organization default_org
ERROR:services.multi_tenant_service:Failed to get secure connection for organization default_org: Access denied to organization default_org
ERROR:services.results_aggregator:Secure database connection error for organization default_org: Secure connection failed: Access denied to organization default_org
Error retrieving recent scans: Secure database connection required for enterprise security compliance: Secure connection failed: Access denied to organization default_org
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_OPEN, cookie=0, name='scans.json'>
INFO:__main__:Dashboard: No user-specific scans, using 0 total recent scans from all users
INFO:__main__:Dashboard: Ensuring all scanner types update dashboard data properly
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/data/scans.json', wd=2, mask=IN_CLOSE_NOWRITE, cookie=0, name='scans.json'>
2025-10-06 21:19:13,593 - scanner.code_profiler - INFO - Performance Monitor [main_app_initialization]: 0.696s, Memory: 0.0MB
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/logs/dataguardian_scanner.log', wd=4, mask=IN_MODIFY, cookie=0, name='dataguardian_scanner.log'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=8, mask=IN_OPEN, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=1, mask=IN_OPEN, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='license_integration.py'>
WARNING:root:License imports failed: cannot import name 'PricingTier' from 'config.pricing_config' (/app/config/pricing_config.py)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=3, mask=IN_OPEN, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=1, mask=IN_OPEN, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=3, mask=IN_CLOSE_NOWRITE, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='pricing_display.py'>
WARNING:root:Pricing imports failed: cannot import name 'PricingTier' from 'config.pricing_config' (/app/config/pricing_config.py)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=8, mask=IN_OPEN, cookie=0, name='download_reports.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=1, mask=IN_OPEN, cookie=0, name='download_reports.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='download_reports.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/download_reports.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='download_reports.py'>
INFO:__main__:Performance optimizations initialized successfully
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_OPEN, cookie=0, name='en.json'>
INIT - Successfully initialized translations for: en
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_CLOSE_NOWRITE, cookie=0, name='en.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=8, mask=IN_OPEN, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=1, mask=IN_OPEN, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/enterprise_orchestrator.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='enterprise_orchestrator.py'>
DEBUG:__main__:Enterprise integration not available (development mode)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/secure_users.json', wd=1, mask=IN_OPEN, cookie=0, name='secure_users.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/secure_users.json', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='secure_users.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_OPEN, cookie=0, name='en.json'>
SET_LANGUAGE - Setting language to: en
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_CLOSE_NOWRITE, cookie=0, name='en.json'>
INIT - Successfully initialized translations for: en
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_OPEN, cookie=0, name='en.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_CLOSE_NOWRITE, cookie=0, name='en.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_OPEN, cookie=0, name='en.json'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/translations/en.json', wd=12, mask=IN_CLOSE_NOWRITE, cookie=0, name='en.json'>
2025-10-06 21:19:22,377 - scanner.code_profiler - INFO - Performance Monitor [main_app_initialization]: 0.130s, Memory: 0.0MB
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/logs/dataguardian_scanner.log', wd=4, mask=IN_MODIFY, cookie=0, name='dataguardian_scanner.log'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=1, mask=IN_OPEN, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='license_integration.py'>
WARNING:root:License imports failed: cannot import name 'PricingTier' from 'config.pricing_config' (/app/config/pricing_config.py)
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=8, mask=IN_OPEN, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=1, mask=IN_OPEN, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/services/license_integration.py', wd=8, mask=IN_CLOSE_NOWRITE, cookie=0, name='license_integration.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=3, mask=IN_OPEN, cookie=0, name='pricing_display.py'>
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=3, mask=IN_CLOSE_NOWRITE, cookie=0, name='pricing_display.py'>
INIT - Successfully initialized translations for: en
DEBUG:watchdog.observers.inotify_buffer:in-event <InotifyEvent: src_path=b'/app/components/pricing_display.py', wd=1, mask=IN_CLOSE_NOWRITE, cookie=0, name='pricing_display.py'>
WARNING:root:Pricing imports failed: cannot import name 'PricingTier' from 'config.pricing_config' (/app/