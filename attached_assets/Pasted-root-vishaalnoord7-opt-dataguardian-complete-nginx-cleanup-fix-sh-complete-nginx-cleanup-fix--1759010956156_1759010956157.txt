root@vishaalnoord7:/opt/dataguardian# ./complete_nginx_cleanup_fix.sh
./complete_nginx_cleanup_fix.sh: line 1: complete_nginx_cleanup_fix#!/bin/bash: No such file or directory
ğŸ”§ COMPLETE NGINX CLEANUP & FIX
===============================
Issue: nginx test fails with 'unknown nonexistent variable' from previous scripts
Fix: Find and remove ALL references, then create clean proxy configuration

ğŸ” STEP 1: DIAGNOSE CURRENT ISSUE
===============================
   âœ… Local Streamlit: 200
   ğŸ“Š Domain status: 200
   ğŸ“Š Domain size: 1837 bytes

ğŸ” Testing current nginx configuration...
âŒ Nginx configuration has errors:
nginx: [warn] "ssl_stapling" ignored, no OCSP responder URL in the certificate "/etc/letsencrypt/live/dataguardianpro.nl/fullchain.pem"
nginx: [warn] "ssl_stapling" ignored, no OCSP responder URL in the certificate "/etc/letsencrypt/live/dataguardianpro.nl/fullchain.pem"
nginx: [emerg] unknown "nonexistent" variable
nginx: configuration file /etc/nginx/nginx.conf test failed

ğŸ” STEP 2: FIND ALL  REFERENCES
==========================================
ğŸ” Searching for all '' references in nginx configuration...
âŒ FOUND problematic references:
/etc/nginx/sites-available/dataguardianpro.nl:        try_files $nonexistent @backend;
/etc/nginx/sites-available/dataguardianpro.nl:        try_files $nonexistent @backend;
/etc/nginx/sites-enabled/dataguardianpro.nl.final-backup.20250928_000337:        try_files $nonexistent @backend;
/etc/nginx/sites-enabled/dataguardianpro.nl.final-backup.20250928_000337:        try_files $nonexistent @backend;
/etc/nginx/sites-enabled/dataguardianpro.nl.simple-backup.20250927_235759:        try_files $nonexistent @backend;
/etc/nginx/sites-enabled/dataguardianpro.nl.simple-backup.20250927_235759:        try_files $nonexistent @backend;

ğŸ“ Files containing '' variable:
   ğŸ“„ /etc/nginx/sites-available/dataguardianpro.nl
   ğŸ“„ /etc/nginx/sites-enabled/dataguardianpro.nl.final-backup.20250928_000337
   ğŸ“„ /etc/nginx/sites-enabled/dataguardianpro.nl.simple-backup.20250927_235759

ğŸ§¹ STEP 3: CLEAN UP PROBLEMATIC REFERENCES
========================================
ğŸ§¹ Cleaning up  references...
   ğŸ“„ Processing: /etc/nginx/sites-available/dataguardianpro.nl
   ğŸ“ Backup created: /etc/nginx/sites-available/dataguardianpro.nl.cleanup-backup.*
   âœ… Removed  references from /etc/nginx/sites-available/dataguardianpro.nl
   ğŸ“„ Processing: /etc/nginx/sites-enabled/dataguardianpro.nl.final-backup.20250928_000337
   ğŸ“ Backup created: /etc/nginx/sites-enabled/dataguardianpro.nl.final-backup.20250928_000337.cleanup-backup.*
   âœ… Removed  references from /etc/nginx/sites-enabled/dataguardianpro.nl.final-backup.20250928_000337
   ğŸ“„ Processing: /etc/nginx/sites-enabled/dataguardianpro.nl.simple-backup.20250927_235759
   ğŸ“ Backup created: /etc/nginx/sites-enabled/dataguardianpro.nl.simple-backup.20250927_235759.cleanup-backup.*
   âœ… Removed  references from /etc/nginx/sites-enabled/dataguardianpro.nl.simple-backup.20250927_235759
âœ… Cleanup completed for 3 files

ğŸ”§ STEP 4: CREATE CLEAN NGINX CONFIGURATION
==========================================
ğŸ“ Backing up main site configuration...
âœ… Backup created
ğŸ“ Creating clean nginx configuration for dataguardianpro.nl...
âœ… Clean nginx configuration created

ğŸ§ª STEP 5: TEST CLEANED CONFIGURATION
====================================
ğŸ” Testing nginx configuration after cleanup...
Nginx test result:
nginx: [warn] "ssl_stapling" ignored, no OCSP responder URL in the certificate "/etc/letsencrypt/live/dataguardianpro.nl/fullchain.pem"
nginx: [warn] "ssl_stapling" ignored, no OCSP responder URL in the certificate "/etc/letsencrypt/live/dataguardianpro.nl/fullchain.pem"
nginx: [emerg] unknown "nonexistent" variable
nginx: configuration file /etc/nginx/nginx.conf test failed
âŒ Critical errors still remain

ğŸ” Additional diagnostics...
Checking for any remaining problematic references:
/etc/nginx/sites-available/dataguardianpro.nl.cleanup-backup.20250928_000840:        try_files $nonexistent @backend;
/etc/nginx/sites-available/dataguardianpro.nl.cleanup-backup.20250928_000840:        try_files $nonexistent @backend;
/etc/nginx/sites-enabled/dataguardianpro.nl.simple-backup.20250927_235759.cleanup-backup.20250928_000840:        try_files $nonexistent @backend;
/etc/nginx/sites-enabled/dataguardianpro.nl.simple-backup.20250927_235759.cleanup-backup.20250928_000840:        try_files $nonexistent @backend;
/etc/nginx/sites-enabled/dataguardianpro.nl.final-backup.20250928_000337.cleanup-backup.20250928_000840:        try_files $nonexistent @backend;
/etc/nginx/sites-enabled/dataguardianpro.nl.final-backup.20250928_000337.cleanup-backup.20250928_000840:        try_files $nonexistent @backend;