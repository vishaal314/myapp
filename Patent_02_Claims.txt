================================================================================
PATENT CLAIMS
Patent #2: Intelligent Database Scanner with Adaptive Sampling
================================================================================

CLAIM 1 (INDEPENDENT CLAIM):

An intelligent database scanner for detecting Personally Identifiable 
Information (PII) in relational databases, comprising:

a) A database connector module that establishes connections with multiple 
   database engines, namely:
   - PostgreSQL databases via psycopg2 connector library
   - MySQL databases via mysql.connector library  
   - Microsoft SQL Server databases via pyodbc connector library
   wherein the connector module automatically selects the appropriate driver 
   protocol based on the database type parameter;

b) A schema analyzer that automatically analyzes database structures by:
   - Retrieving table metadata via information_schema queries
   - Calculating row counts per table via COUNT(*) queries
   - Identifying column datatypes and column names
   - Generating a complete schema inventory with table hierarchy;

c) A priority calculator that computes risk scores for each table according 
   to the following algorithm:
   - Score 3.0 for tables with names containing: 'user', 'customer', 
     'employee', 'person', 'medical', 'health', 'patient'
   - Score 2.8 for tables with names containing: 'payment', 'transaction', 
     'invoice', 'billing'
   - Score 2.5 for tables with names containing: 'communication', 'message', 
     'email', 'notification'
   - Score 2.0 for tables with names containing: 'address', 'location', 
     'contact'
   - Score 1.5 for all other tables
   - Extra score bonus (+0.5 to +0.8) for columns with PII indicators 
     such as 'email', 'phone', 'ssn', 'bsn';

d) An adaptive sampling engine that implements three configurable scan modes:
   - FAST mode: 100 rows sample per table with 2 parallel workers
   - SMART mode: 300 rows sample per table with 3 parallel workers
   - DEEP mode: 500 rows sample per table with 3 parallel workers
   wherein the sample size and worker count are statically defined per mode 
   and not dynamically adjusted;

e) A PII detection engine that identifies Netherlands-specific personal data, 
   including:
   - BSN numbers (Burgerservicenummer) consisting of 9 digits, validated 
     according to the official 11-proef algorithm wherein the checksum is 
     calculated as: (9×d₁ + 8×d₂ + 7×d₃ + 6×d₄ + 5×d₅ + 4×d₆ + 3×d₇ + 2×d₈ - 1×d₉) 
     mod 11 = 0
   - Dutch email addresses with .nl top-level domain
   - Dutch phone numbers in formats +31 6 or 06
   - Dutch postcodes in format nnnn XX (4 digits + 2 letters)
   wherein invalid BSN numbers with incorrect checksums are rejected;

f) A parallel processing manager that uses Python's concurrent.futures.
   ThreadPoolExecutor with configurable worker pools wherein:
   - The number of workers is exactly 2 for FAST mode scans
   - The number of workers is exactly 3 for SMART and DEEP mode scans
   - Each worker scans a separate table without data overlapping
   - Results from all workers are aggregated in a central collector.

================================================================================

CLAIM 2 (DEPENDENT ON CLAIM 1):

A database scanner according to claim 1, wherein the database connector module 
further comprises:

a) A connection parameter validation system that verifies:
   - Host parameter is a valid hostname or IP address
   - Port parameter is an integer between 1 and 65535
   - Database name parameter is a non-empty string
   - User credentials are present and non-empty;

b) A connection pooling mechanism that:
   - Maintains a maximum of 10 simultaneous database connections
   - Reuses connections for consecutive queries
   - Automatically handles timeouts after 30 seconds of inactivity
   - Retries failed connections with exponential backoff;

c) An error handling layer that converts database-specific exceptions to 
   standardized error codes, including:
   - CONNECTION_FAILED (code: 1001) for authentication errors
   - QUERY_TIMEOUT (code: 1002) for queries exceeding 60 seconds
   - PERMISSION_DENIED (code: 1003) for missing SELECT privileges
   - INVALID_SYNTAX (code: 1004) for SQL syntax errors.

================================================================================

CLAIM 3 (DEPENDENT ON CLAIM 1):

A database scanner according to claim 1, wherein the priority calculator 
further comprises:

a) A name-matching algorithm that applies case-insensitive substring matching 
   to table names, wherein:
   - Table name is converted to lowercase for comparison
   - Partial matches are accepted (e.g., 'customers' matches 'customer')
   - Multiple keywords in one table name result in the highest score
   - Special characters (_, -, .) are ignored in matching;

b) A column analysis module that increases priority based on:
   - Columns named 'email' or 'e_mail': +0.5 points
   - Columns named 'phone' or 'telephone': +0.3 points
   - Columns named 'ssn', 'bsn', or 'social_security': +0.8 points
   - Columns with datatype 'VARCHAR' or 'TEXT' receive extra analysis
   - Maximum total score is capped at 5.0 regardless of matches;

c) A risk classification system that categorizes tables into:
   - HIGH risk (score ≥ 2.5): Mandatory scanning in all modes
   - MEDIUM risk (score 1.5 - 2.4): Scanning in SMART and DEEP modes
   - LOW risk (score < 1.5): Only scanning in DEEP mode
   wherein the classification is stored in the schema metadata.

================================================================================

CLAIM 4 (DEPENDENT ON CLAIM 1):

A database scanner according to claim 1, wherein the adaptive sampling engine 
further comprises:

a) A strategic table selection algorithm that:
   - In FAST mode: scans maximum 15 tables, sorted by highest priority
   - In SMART mode: scans all tables without limitation
   - In DEEP mode: scans maximum 75 tables, sorted by highest priority
   wherein tables are always sorted on descending priority score before 
   applying the limit;

b) A sample query generator that constructs SQL LIMIT clauses as:
   - "SELECT * FROM {table_name} LIMIT {sample_size}" for PostgreSQL and MySQL
   - "SELECT TOP {sample_size} * FROM {table_name}" for SQL Server
   wherein {sample_size} is exactly 100, 300, or 500 depending on scan mode;

c) A row sampling verification mechanism that:
   - Checks if the actual number of scanned rows ≤ sample_size
   - Logs a warning if a table has fewer rows than sample_size
   - Calculates database coverage percentage as (scanned_rows / total_rows) × 100%
   - Maintains statistics about minimum, maximum, and average sample sizes.

================================================================================

CLAIM 5 (DEPENDENT ON CLAIM 1):

A database scanner according to claim 1, wherein the PII detection engine 
further comprises:

a) A BSN validation module that implements the 11-proef algorithm according to:
   
   STEP 1: Input validation
   - Check that BSN contains exactly 9 digits
   - Reject BSN with letters or special characters
   - Accept BSN with leading zeros (e.g., 012345678)
   
   STEP 2: Checksum calculation
   - For position i=0 to i=7: multiply digit by (9-i)
   - For position i=8: multiply digit by -1
   - Sum all products: checksum = Σ(digit[i] × multiplier[i])
   
   STEP 3: Modulo validation
   - Calculate: checksum mod 11
   - BSN is VALID if result = 0
   - BSN is INVALID if result ≠ 0
   
   EXAMPLE CALCULATION for BSN 111222333:
   (1×9) + (1×8) + (1×7) + (2×6) + (2×5) + (2×4) + (3×3) + (3×2) - (3×1)
   = 9 + 8 + 7 + 12 + 10 + 8 + 9 + 6 - 3 = 66
   66 mod 11 = 0 → VALID BSN;

b) A regex-based extraction system for Dutch PII patterns:
   - Email: r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.nl\b'
   - Phone: r'\b(06|(\+31\s?6))[\s-]?\d{8}\b'
   - Postcode: r'\b\d{4}\s?[A-Z]{2}\b'
   - IBAN: r'\bNL\d{2}[A-Z]{4}\d{10}\b'
   wherein matches are extracted from VARCHAR, TEXT, and CHAR columns;

c) A GDPR article mapping system that links detected PII to:
   - BSN → Article 9 (Special categories of personal data)
   - Email/Phone → Article 6 (Lawfulness of processing)
   - Medical data → Article 9 (Special categories)
   - Financial data → Article 6 + Article 32 (Security)
   wherein each found PII item is labeled with the relevant article.

================================================================================

CLAIM 6 (DEPENDENT ON CLAIM 1):

A database scanner according to claim 1, wherein the parallel processing 
manager further comprises:

a) A ThreadPoolExecutor configuration system that:
   - For FAST mode: initializes ThreadPoolExecutor(max_workers=2)
   - For SMART mode: initializes ThreadPoolExecutor(max_workers=3)  
   - For DEEP mode: initializes ThreadPoolExecutor(max_workers=3)
   wherein max_workers is a static value per mode and not dynamically 
   adjusted based on CPU cores or database load;

b) A work distribution algorithm that:
   - Divides tables across workers based on priority score
   - Ensures load balancing by sorting tables on estimated row count
   - Assigns each worker an equal number of tables (± 1 table difference)
   - Assigns high-priority tables first to available workers;

c) A result aggregation mechanism that:
   - Collects futures from all workers via executor.submit() calls
   - Waits until all futures are complete via concurrent.futures.wait()
   - Catches and logs exceptions from failed workers without stopping scan
   - Merges successful results into a master result dictionary with keys:
     * 'total_findings': sum of all PII findings
     * 'total_rows_scanned': sum of all scanned rows
     * 'tables_scanned': number of successfully scanned tables
     * 'scan_duration': total time in seconds
     * 'findings_by_type': dictionary with PII type as key and count as value.

================================================================================
TOTAL NUMBER OF CLAIMS: 6
================================================================================

INDEPENDENT CLAIM: Claim 1
DEPENDENT CLAIMS: Claims 2, 3, 4, 5, 6 (each dependent on claim 1)

SCOPE OF PROTECTION:
The scope of protection of this patent is determined by the claims, wherein 
the description and drawings serve for explanation but not for limitation of 
the claims.

INVENTIVE STEP JUSTIFICATION:
These claims contain multiple inventive steps that are NOT obvious to a 
person skilled in the art:

1. The specific combination of sample sizes (100/300/500) with worker counts 
   (2/3/3) is NOT standard in the industry and requires empirical optimization

2. BSN 11-proef validation is NOT implemented in existing database scanners 
   (OneTrust, BigID, Varonis)

3. The priority scoring system with Dutch risk factors is a NEW approach 
   specific for UAVG compliance

4. The combination of adaptive sampling + parallel processing + BSN validation 
   in one integrated system is NEW and NON-OBVIOUS

NOVELTY JUSTIFICATION:
No existing database scanner combines:
- Adaptive sampling with 3 exact modes (100/300/500 rows)
- BSN validation with 11-proef algorithm
- Dutch PII detection (.nl emails, NL postcodes, +31 phones)
- Multi-database support (PostgreSQL, MySQL, SQL Server)
- Priority-based scanning with 6 risk categories

INDUSTRIAL APPLICABILITY:
This invention is directly applicable for:
- GDPR/AVG compliance audits in Dutch organizations
- UAVG-specific PII inventory
- Database security assessments
- Data protection impact assessments (DPIA)
- Automated privacy compliance monitoring

================================================================================
END OF CLAIMS
================================================================================
