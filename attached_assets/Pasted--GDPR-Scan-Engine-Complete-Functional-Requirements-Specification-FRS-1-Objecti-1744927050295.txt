**GDPR Scan Engine - Complete Functional Requirements Specification (FRS)**

---

### 1. Objective
Design and implement a GDPR Scan Engine to identify and report on GDPR-relevant Personally Identifiable Information (PII) across multiple sources. The engine will adhere to the GDPR core principles, with a focus on Dutch-specific rules (UAVG), consent management (especially for minors), breach timeline reporting per Autoriteit Persoonsgegevens, and legal basis documentation.

---

### 2. Core GDPR Principles (Implementation Guidelines)
- **Lawfulness, Fairness, Transparency**: All scans must log metadata of processing.
- **Purpose Limitation**: Flag data used outside defined scope.
- **Data Minimization**: Highlight unused or excessive data.
- **Accuracy**: Validate if detected data is recent and correct.
- **Storage Limitation**: Detect outdated or stale PII.
- **Integrity & Confidentiality**: Secure data in transit and at rest.
- **Accountability**: Generate audit logs and traceable report links.

---

### 3. Netherlands-Specific GDPR (UAVG) Requirements
- Comply with Dutch rules around BSN, medical records, and employment data.
- Consent flag for minors (<16 years).
- Maintain legal basis documentation (contract, consent, vital interest, etc.).
- Integrate with AP's 72-hour breach notification framework.
- Alert on high-risk PII under Dutch categorization.

---

### 4. System Architecture Overview

```
User/API Call → DSR Orchestrator (Azure Function)
              ↓
       +-------------------------+
       | Scanning Services       |
       | - code-scanner          |
       | - blob-scanner          |
       | - image-scanner         |
       | - db-scanner            |
       | - api-scanner           |
       | - manual-upload-tool    |
       | - sustainability-scanner|
       | - ai-model-scanner      |
       | - soc2-scanner          |
       +-------------------------+
              ↓
     Results Aggregator DB (Postgres/Cosmos)
              ↓
     Streamlit Dashboard / Power BI Reports
```

---

### 5. Folder & Module Structure
```
gdpr-scan-engine/
├── services/
│   ├── code-scanner/
│   ├── blob-scanner/
│   ├── image-scanner/
│   ├── db-scanner/
│   ├── api-scanner/
│   ├── manual-upload-tool/
│   ├── sustainability-scanner/
│   ├── ai-model-scanner/
│   ├── soc2-scanner/
│   ├── dsr-orchestrator/
│   └── results-aggregator/
├── dashboard/
├── shared/
├── scripts/
├── docker-compose.yml
├── requirements.txt
└── README.md
```

---

### 6. Scanner Modules Breakdown
| Module               | Stack                        | Purpose |
|----------------------|------------------------------|---------|
| code-scanner         | Python + TruffleHog/Semgrep  | Detect PII/secrets in code |
| blob-scanner         | Python + Presidio + OCR      | Scan PDFs/DOCs for PII |
| image-scanner        | Azure Vision API             | Visual identity, faces |
| db-scanner           | ADF + Presidio               | Structured DB scan |
| api-scanner          | FastAPI + Swagger + NLP      | API input/output scanning |
| manual-upload-tool   | Streamlit                    | Upload manual files |
| sustainability       | Azure APIs                   | ESG compliance check |
| ai-model-scanner     | Azure AI Content/NLP         | Scan AI models for data leakage |
| soc2-scanner         | Python rule engine           | SOC2-specific logging/access rules |

---

### 7. Features & Functional Requirements

**Authentication & Access**
- Login via Gmail or corporate ID
- Role-based access (admin, analyst, viewer)

**Scan Execution & Storage**
- Scan type selection UI
- Store result JSON locally and in DB
- All results exportable as PDF
- PDF report must be branded and professional

**Consent and Legal Basis**
- Store and validate consent metadata
- Document legal basis for high-risk PII
- Flag missing consent for minors

**Region Support**
- Select scan region: Netherlands, Germany, France, Belgium
- Regional-specific rules apply dynamically

**Dashboard**
- Risk score per scan
- Time-series trends
- Top PII types, violations
- Export all views as image/PDF/CSV
- Available on web and mobile

**Scalability & Reliability**
- Async scanning with queueing (Azure Service Bus)
- Parallel scan execution
- Auto-scaling of Azure Functions

**Report Generation**
- On-demand or auto-report post scan
- PDF and JSON export
- Red flag summary for compliance teams

**Payment System**
- Stripe integration
- Plans:
  - Free: 10 scans/day
  - Premium: 20 EUR/month
  - Gold: TBD

---

### 8. CI/CD & DevOps
- GitHub Actions for pipeline
- Terraform infra provisioning
- Pre-prod + Prod environments
- Dockerized deployments

---

### 9. Observability
- Azure Monitor for logs
- Central logging with scan metadata
- Grafana or Power BI dashboards for metrics
- Alerts on scan errors or high-risk detection

---

### 10. Localization
- English & Dutch UI
- Region-based legal terms in reports
- Exported PDF supports both languages

---

### 11. Integrations
- Azure AD B2B SSO
- Webhooks for Teams, Slack
- SIEM Integration (Sentinel)
- ServiceNow incident trigger

---

### 12. Testing
- 85% unit test coverage
- Large file test cases
- DB schema with 50+ tables
- Simulate attackers uploading malformed data

---

### 13. Compliance & Recovery
- Full audit trails
- Auto-delete user data after X days
- Backup Postgres/Cosmos daily
- GDPR DSR support: right to delete

---

### 14. Future Enhancements
- GPT-based Risk Explainer
- Plugin support for third-party scanners
- Risk-Based Access Controls
- White-labeling for MSPs

---

**End of Document**

