â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  DataGuardian Pro - External Server Deployment Guide
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ PACKAGE CONTENTS:
  âœ… dataguardian_complete.tar.gz (1.1MB)
  âœ… FIX_EXTERNAL_SERVER.sh (included in tar.gz)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  STEP 1: UPLOAD TO EXTERNAL SERVER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

From your local machine:

    scp dataguardian_complete.tar.gz root@dataguardianpro.nl:/tmp/

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  STEP 2: EXTRACT ON EXTERNAL SERVER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SSH into server:

    ssh root@dataguardianpro.nl

Backup old installation:

    mv /opt/dataguardian /opt/dataguardian.backup.$(date +%Y%m%d_%H%M%S)

Extract new code:

    mkdir -p /opt/dataguardian
    cd /opt/dataguardian
    tar -xzf /tmp/dataguardian_complete.tar.gz

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  STEP 3: RUN FIX SCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Make script executable and run:

    chmod +x /opt/dataguardian/FIX_EXTERNAL_SERVER.sh
    sudo /opt/dataguardian/FIX_EXTERNAL_SERVER.sh

Wait ~3 minutes for:
  âœ… Fresh encryption keys generation
  âœ… Redis startup
  âœ… Old encrypted data cleanup
  âœ… Docker rebuild
  âœ… Container restart

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  STEP 4: TEST IN INCOGNITO BROWSER (MANDATORY!)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  CRITICAL: You MUST use INCOGNITO mode!

Why?
  âŒ Your regular browser cached the old error page
  âŒ Regular tabs will ALWAYS show 'stats' error (cached)
  âœ… Incognito bypasses ALL cache
  âœ… Shows actual server state

How to test:

  1. CLOSE ALL browser tabs for dataguardianpro.nl
  2. Press Ctrl+Shift+N (Chrome/Edge) or Ctrl+Shift+P (Firefox)
  3. Open INCOGNITO/PRIVATE window
  4. Visit: https://dataguardianpro.nl
  5. Login: vishaal314 / password123
  6. Try Code Scanner: https://github.com/rijdendetreinen/gotrain

Expected results:
  âœ… Dashboard loads
  âœ… NO 'stats' error
  âœ… NO encryption errors
  âœ… All scanners work

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  WHAT THE FIX SCRIPT DOES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Phase 1: Generate fresh encryption keys
  â†’ New DATAGUARDIAN_MASTER_KEY (32-byte base64)
  â†’ New JWT_SECRET
  â†’ Preserves OPENAI_API_KEY and STRIPE_SECRET_KEY

Phase 2: Start Redis
  â†’ redis-server --port 6379 --bind 127.0.0.1
  â†’ FLUSHALL (clear cache)

Phase 3: Clear old encrypted data (FIXES "Incorrect padding")
  â†’ UPDATE scan_results SET encrypted_payload = NULL;
  â†’ UPDATE certificates SET encrypted_report = NULL;
  â†’ UPDATE api_credentials SET encrypted_credentials = NULL;

Phase 4: Clear Python cache
  â†’ Delete all .pyc files
  â†’ Remove __pycache__ directories

Phase 5: Rebuild Docker
  â†’ docker build --no-cache -t dataguardian-pro .

Phase 6: Start container
  â†’ docker run --network host --env-file /root/.dataguardian_env

Phase 7: Wait 60 seconds for initialization

Phase 8: Automatic verification
  â†’ Check for 'stats' errors (should be NONE)
  â†’ Check for encryption errors (should be NONE)
  â†’ Verify Streamlit started

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

If you STILL see 'stats' error after following steps above:

  âŒ You are NOT using incognito mode
  âŒ Your browser cache is showing old error page
  âœ… Check server logs - they show NO 'stats' error
  âœ… The error is ONLY in browser cache

To verify server is working:

    docker logs dataguardian-container 2>&1 | tail -50

You should see:
  âœ… "You can now view your Streamlit app in your browser"
  âœ… NO "UnboundLocalError: cannot access local variable 'stats'"
  âœ… NO "Incorrect padding" errors

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  MONITOR LOGS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Real-time logs:

    docker logs dataguardian-container -f

Check for specific errors:

    docker logs dataguardian-container 2>&1 | grep -i "stats\|padding\|error"

Should show:
  âœ… NO 'stats' errors
  âœ… NO 'padding' errors
  âœ… Normal application startup

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  FILES INCLUDED IN PACKAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  app.py                         - Main Streamlit application
  services/                      - All scanner services
  components/                    - UI components
  utils/                         - Utility functions
  FIX_EXTERNAL_SERVER.sh        - Automated fix script

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Upload: scp dataguardian_complete.tar.gz root@dataguardianpro.nl:/tmp/
2. Extract: cd /opt/dataguardian && tar -xzf /tmp/dataguardian_complete.tar.gz
3. Fix: sudo ./FIX_EXTERNAL_SERVER.sh
4. Test: INCOGNITO browser â†’ https://dataguardianpro.nl

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
