PAGINA 5 van 8
     
230  2. Signal Detection Algorithm
     
     def detect_early_warnings(self, scan_history: List[Dict[str, Any]]) -> List[str]:
         """Detect early warning signals in scan history."""
         warnings = []
235      
         if len(scan_history) < 2:
             return warnings
         
         recent_scans = scan_history[-30:]  # Last 30 scans
240      older_scans = scan_history[-60:-30]  # Previous 30 scans
         
         # Signal 1: Increasing critical findings
         recent_critical = sum(1 for s in recent_scans 
                              if any(f.get('severity') == 'Critical' 
245                                 for f in s.get('findings', [])))
         older_critical = sum(1 for s in older_scans 
                             if any(f.get('severity') == 'Critical' 
                                   for f in s.get('findings', [])))
         
250      if recent_critical > older_critical  1.2:  # 20% increase
             warnings.append("increasing_critical_findings")
         
         # Signal 2: Decreasing scan frequency
         recent_avg_interval = self._calculate_avg_scan_interval(recent_scans)
255      older_avg_interval = self._calculate_avg_scan_interval(older_scans)
         
         if recent_avg_interval > older_avg_interval  2:  # 2Ã— normal
             warnings.append("decreasing_scan_frequency")
         
260      # Signal 3: Longer remediation times
         recent_remediation = self._calculate_avg_remediation_time(recent_scans)
         older_remediation = self._calculate_avg_remediation_time(older_scans)
         
         if recent_remediation > older_remediation  1.5:  # 50% increase
265          warnings.append("longer_remediation_times")
         
         return warnings
     
     C. NETHERLANDS RISK MULTIPLIERS
270  
     1. Region-Specific Risk Calculation
     
     risk_multipliers = {
         "netherlands_specific": {
275          "bsn_processing": 1.8,           # BSN = special category data
             "healthcare_data": 1.6,          # Medical data extra protection
             "financial_services": 1.4,       # Financial sector regulations
             "public_sector": 1.3,            # Government obligations
             "cross_border_eu": 1.2           # International transfers
280      },
         
         "eu_regulations": {
             "gdpr_article_9": 2.0,           # Special category data
             "ai_act_high_risk": 1.7,         # High-risk AI systems
285          "nis2_directive": 1.5,           # Critical infrastructure
             "dora_financial": 1.6            # Digital operational resilience
         },
         
         "industry_factors": {
290          "financial_services": 1.4,
             "healthcare": 1.6,
             "technology": 1.3,
             "retail": 1.1,
             "government": 1.3
295      }
     }
     
     